filter {
  if [logtype] == "bro_dnp3" {
    grok {
      patterns_dir => [ "/etc/logstash/patterns" ] 
      match => [ "message", '\<%{NUMBER:pri}\>%{BSDDATE:date} %{DATA:loghost} %{DATA:logtype}: %{BRODNP3SO}' ]
      add_tag => [ "grokked" ]
      overwrite => [ "date", "logtype" ]
      remove_field => [ "loghost", "message", "pri", "uid" ]
    }
  }
}

